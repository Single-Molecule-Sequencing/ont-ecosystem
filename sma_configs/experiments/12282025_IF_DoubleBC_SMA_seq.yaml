experiment:
  id: 12282025_IF_DoubleBC_SMA_seq
  date: '2025-12-28'
  type: double_barcode
  description: Double barcode SMA-seq experiment - CLEAN SUCCESS
  prepared_by: Isaac Farnum
  prep_date: '2025-12-28'

library_prep:
  protocol: cleavage_ligation_cycling
  method: one_tube
  barcode_design: both_ends
  cycling:
    initial_cleavage: "37C for 10 min"
    cycling_program: "37C 3min / 16C 3min x 10 cycles"
    final_cleavage: "37C for 15 min"
  steps:
    - step: 1
      action: "One-tube cleavage-ligation cycling"
      details: "V0-4.2 and V0-4.4 ONLY (even-numbered plasmids) - eliminates daisy chaining"
  loading:
    volume_ul: 2.2
    amount_fmol: 50
  barcode_scheme: modified_double
  key_innovation: "Odd/even plasmid separation - only even plasmids used"

paths:
  data_root: /data1/12282025_IF_DoubleBC_SMA_seq
  run_id: 20251228_2100_MD-100098_FBD69411_7c69187c
  pod5_dir: /data1/12282025_IF_DoubleBC_SMA_seq/no_sample_id/20251228_2100_MD-100098_FBD69411_7c69187c/pod5_pass
  bam_dir: /data1/12282025_IF_DoubleBC_SMA_seq/no_sample_id/20251228_2100_MD-100098_FBD69411_7c69187c/bam_pass
  fastq_dir: /data1/12282025_IF_DoubleBC_SMA_seq/no_sample_id/20251228_2100_MD-100098_FBD69411_7c69187c/fastq_pass
  sequencing_summary: /data1/12282025_IF_DoubleBC_SMA_seq/no_sample_id/20251228_2100_MD-100098_FBD69411_7c69187c/sequencing_summary_FBD69411_7c69187c_b360fe42.txt
  sample_sheet: /data1/12282025_IF_DoubleBC_SMA_seq/no_sample_id/20251228_2100_MD-100098_FBD69411_7c69187c/sample_sheet_FBD69411_20251228_2022_7c69187c.csv

sequencing:
  device: PromethION
  position_id: MD-100098
  flow_cell_id: FBD69411
  flow_cell_product: FLO-MIN114
  kit: SQK-NBD114-24
  protocol_run_id: 7c69187c-5fcf-45e9-b3c2-4492a81f9f55

# =============================================================================
# SAMPLE BARCODE MAPPING
# =============================================================================
# This experiment uses ONLY even-numbered plasmids (V0-4.2, V0-4.4) to prevent
# daisy chaining caused by adjacent plasmid backbone ligation.

samples:
  # Forward barcodes - ligate to 5' end of target
  barcode02:
    alias: V04_2
    target_id: V0-4.2
    custom_barcode: NB02
    overhang: AGGA
    orientation: forward
    condition: standard
    replicate: 1
    barcode_type: single
    notes: "Standard single barcode"

  barcode04:
    alias: V04_4
    target_id: V0-4.4
    custom_barcode: NB04
    overhang: TGGT
    orientation: forward
    condition: standard
    replicate: 1
    barcode_type: single
    notes: "Standard single barcode"

  # Reverse barcodes - ligate to 3' end of target
  barcode07:
    alias: V04_2_rev
    target_id: V0-4.2
    custom_barcode: NB07
    overhang: CTCT
    orientation: reverse
    condition: double_barcode
    replicate: 2
    barcode_type: double
    notes: "Double-barcoded V0-4.2 variant"

  barcode09:
    alias: V04_4_rev
    target_id: V0-4.4
    custom_barcode: NB09
    overhang: TCAG
    orientation: reverse
    condition: double_barcode
    replicate: 2
    barcode_type: double
    notes: "Double-barcoded V0-4.4 variant"

reference:
  targets_file: ../targets/sma_targets.yaml
  barcodes_file: ../targets/sma_barcodes.yaml
  use_sequence: designed
  validate_against_sanger: true
  fasta: references/reference.fa
  targets_only: references/reference_targets.fa

expected_products:
  type: double_barcode
  structure: "PREFIX(13bp) + ADAPTER(15bp) + FLANK_F(8bp) + BARCODE(22-24bp) + FLANK_R(8bp) + TARGET"
  note: "Even-only plasmids eliminate daisy chain artifacts"

  forward_products:
    NB02_V0-4.2_forward: {barcode: NB02, target: V0-4.2, overhang: AGGA, expected_size: 236}
    NB04_V0-4.4_forward: {barcode: NB04, target: V0-4.4, overhang: TGGT, expected_size: 231}

  reverse_products:
    NB07_V0-4.2_reverse: {barcode: NB07, target: V0-4.2, overhang: CTCT, expected_size: 236}
    NB09_V0-4.4_reverse: {barcode: NB09, target: V0-4.4, overhang: TCAG, expected_size: 231}

  daisy_chain_pairs: []  # None - even-only plasmids prevent this

analysis:
  min_read_length: 100
  max_read_length: 500
  min_qscore: 10
  size_classification: true
  alignment_validation: true

output:
  base_dir: /data2/repos/ont-ecosystem/sma_configs/experiments/12282025_IF_DoubleBC_SMA_seq
  generate_reference_fasta: true
  generate_sample_sheet_csv: true

# =============================================================================
# ANALYSIS RESULTS (generated 2025-12-30)
# =============================================================================
analysis_results:
  status: clean
  total_reads: 1445165
  total_bases_mb: 173.9
  n50_bp: 149
  mean_qscore: 11.9
  median_qscore: 16.0
  signal_positive_pct: 99.8
  analysis_date: '2025-12-30'
  notes: |
    SUCCESS - Odd/even plasmid fix validated.
    Using only V0-4.2 and V0-4.4 (even-numbered) eliminated daisy chaining.
    N50 of 149bp matches expected amplicon size.
    Unimodal length distribution confirms clean library.

  peak_interpretation:
    peak_150bp: "Clean single-target amplicons (expected)"
    no_2600bp_peak: "No daisy chains - fix validated"

  coverage_by_target:
    V0-4.2: "Forward (NB02) + Reverse (NB07)"
    V0-4.4: "Forward (NB04) + Reverse (NB09)"

  validation:
    fix_validated: true
    fix_description: "Odd/even plasmid separation eliminates daisy chaining"
    comparison_experiment: "12232025_IF_DoubleBC_SMA_seq (N50=2613bp with all plasmids)"
