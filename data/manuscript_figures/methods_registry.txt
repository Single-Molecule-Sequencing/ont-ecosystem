METHODS

Experiment Registry Construction

Data Sources
The ONT experiment registry was constructed from two primary data sources: (1) local sequencing experiments performed on institutional computing infrastructure, and (2) publicly available datasets from the Oxford Nanopore Technologies Open Data repository (ont-open-data S3 bucket). Local experiments were discovered through systematic traversal of designated sequencing data directories on high-performance computing (HPC) clusters and local storage systems. Public datasets were identified and catalogued through programmatic queries to the ONT Open Data registry.

Metadata Extraction
Experiment metadata was extracted from multiple source files using a hierarchical approach:

1. Primary sources: MinKNOW-generated final_summary.txt files containing run parameters including flow cell ID, protocol configuration, sample identification, and sequencing timestamps.

2. Secondary sources: BAM file headers parsed using samtools view -H, extracting read group (@RG) information including platform model, basecalling configuration, and run identifiers.

3. Tertiary inference: Pattern-based extraction from file paths and experiment names using regular expressions to identify sample types, clinical identifiers, and experimental conditions when primary metadata was unavailable.

Metadata Schema
Each experiment record contains the following standardized fields:

- Identification: Unique experiment ID (UUID-based), human-readable name, run ID
- Sample information: Sample name, sample category (Plasmid, Human, Research, Pharmacogenomics, Microbial, CRISPR, Cancer, Lab Run, Multiplex), clinical sample ID where applicable
- Technical parameters: Chemistry version (R10.4.1, R10.4), basecaller software (dorado, guppy), basecalling model (hac, sup, fast), device type (MinION Mk1D, MinION, PromethION, P2 Solo, Flongle), flow cell type and ID
- Quality metrics: Mean Q-score, N50 read length, total reads, total bases
- Provenance: Registration timestamp, last update, data source, validation status

Quality Score Computation
Mean quality scores were computed using probability-space averaging to correctly handle the logarithmic Phred scale:

Q̄ = -10 log₁₀(1/n Σᵢ 10^(-Qᵢ/10))

where Qᵢ represents individual read quality scores. This approach prevents underestimation of error rates that would result from direct arithmetic averaging of Q-scores.

N50 Calculation
The N50 metric was calculated as the read length at which 50% of the total sequenced bases are contained in reads of that length or longer.

Registry Validation and Enrichment

Completeness Assessment
Registry completeness was assessed using a weighted scoring system:
- Critical fields (2 points each): sample, chemistry, basecall_model
- Important fields (1 point each): basecaller, flowcell_type, device_type, run_date
- QC metrics (1 point each): mean_qscore, n50

Experiments were classified as: good (≥8 points), warning (5-7 points), or poor (<5 points).

Automated Enrichment
Missing metadata fields were inferred using the following rules:

1. Chemistry inference: R10.4.1 assigned for experiments dated 2023 or later; R10.4 for 2022; R9.4.1 for earlier experiments.

2. Basecaller inference: Dorado assigned for experiments dated September 2022 or later; guppy for earlier experiments, based on the official deprecation timeline.

3. Device inference: Derived from flow cell type (FLO-PRO114M → PromethION; FLO-MIN114 → MinION; FLO-FLG114 → Flongle).

4. Sample category inference: Pattern matching against 30+ regular expressions identifying sample types from experiment names.

Deep Scrutiny Protocol
A comprehensive validation pass was performed on all registry entries:

1. Local experiments (n=11): Source files re-analyzed, BAM headers re-extracted, QC metrics recomputed from read data.

2. Public datasets (n=21): BAM headers streamed from S3 URLs using range requests to minimize bandwidth while extracting metadata.

3. HPC experiments (n=134): Metadata inferred from paths and naming conventions; flagged for future QC analysis when HPC access is available.

Data Storage and Versioning
The registry is maintained as a YAML-formatted file (experiments.yaml) with event-sourced provenance tracking. Each modification is logged with timestamps, enabling full audit trails. The registry is synchronized to a Git repository for version control.

Software and Dependencies
Registry construction and analysis utilized Python 3.9+ with PyYAML, pysam, matplotlib, and NumPy. Basecalling information was extracted from dorado (v7.x) and guppy (v6.x) output files.

Data Availability
The complete experiment registry is available at https://github.com/Single-Molecule-Sequencing/ont-ecosystem in the data/ directory.
